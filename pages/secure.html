<!DOCTYPE html>
<html lang="en">

<!-- linking scripts and whatnot -->
</head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../CSS/base.css"/>
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.3/core.css">
    <script type="module" src="https://pyscript.net/releases/2024.1.3/core.js"></script>
    <title>Secure</title>
</head>

<!-- body containing main contents -->
<body>
    <h1 id="loading">Loading /^w^/</h1> <!-- is deleted once page is done loading -->
    <div id="secure removal" class="hidden"> <!-- is removed upon successful access -->
        <!-- linking pyscript packages -->
        <py-config>
            packages = ['requests', 'cryptography']
        </py-config>
        <script type="py" src="../pyscript/secure.py"></script> <!-- https://docs.pyscript.net/2024.3.1/user-guide/first-steps/ -->
        <!-- getting tokens and selection -->
        <form id="token form">
            <input type="text" id="main input token" placeholder="main input token">
            <input type="text" id="secondary input token" placeholder="secondary input token">
            <select name="appload" id="appload"></select> <!-- https://www.w3schools.com/tags/tag_select.asp -->
            <button type="submit" id="submit token", pyclick="submit_token()">Submit</button>
        </form>
    </div>
</body>

<!-- script for setting up pyscript and removing some elements -->
<div id="script removal"> <!-- is removed upon successful access -->
    <script src="../JS/load.js"></script>
    <py-script>
        from js import document, console, fetch
        from pyodide.ffi import create_proxy

        async def process_click(why):
            await secure.submit_token()
        
        function_proxy = create_proxy(process_click)
        document.getElementById("token form").addEventListener("submit", function_proxy)
        console.log('[PYTHON MANAGER] Created proxy')

        js.document.getElementById("loading").remove()
        js.document.getElementById("secure removal").classList.toggle("hidden")
    </py-script>
</div>
<div id="injection point"></div>
</html>